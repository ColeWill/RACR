function initMap(){var n={lat:39.758416,lng:-105.007525};map=new google.maps.Map(document.getElementById("map"),{center:n,zoom:16}),google.maps.event.addListener(map,"click",function(n){pinLat=n.latLng.lat(),pinLng=n.latLng.lng();var o={lat:pinLat,lng:pinLng};checkPoints.push(o),console.log("pinLat: "+pinLat),console.log("pinLng: "+pinLng);for(var e=checkPoints.length-1;e>=0;e--)new google.maps.Marker({position:checkPoints[e],map:map,draggable:!0})})}function handleLocationError(n,o,e){o.setPostion(e),o.setContent(n?"Error: geolocation service failure":"Your Browser does not support geolocation"),o.open(map)}var app=angular.module("RCR",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(n,o){n.when("/",{templateUrl:"../templates/template.html"}),o.html5Mode({enabled:!0,requireBase:!1})}]),console.log("client.js connected");var map,infoWindow,pinLat,pinLng,checkPoints=[];locate=document.getElementById("locate"),locate.addEventListener("click",function(){infoWindow=new google.maps.InfoWindow,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(n){var o={lat:n.coords.latitude,lng:n.coords.longitude};console.log("pos:"),console.log("your lat: "+o.lat),console.log("your lng: "+o.lng),infoWindow.setPosition(o),infoWindow.setContent("Starting Point"),infoWindow.open(map),map.setCenter(o)},function(){handleLocationError(!0,infoWindow,map.getCenter())}):handleLocationError(!1,infoWindow,map.GetCenter())});var destination={lat:39.758091,lng:-105.0073735},start=document.getElementById("start");start.addEventListener("click",function(){console.log("start running"),document.getElementById("stop").addEventListener("click",function(){console.log("STOPPED..."),clearInterval(n)});var n=window.setInterval(function(){var o=navigator.geolocation;infoWindow=new google.maps.InfoWindow,o.getCurrentPosition(function(o){var e={lat:o.coords.latitude,lng:o.coords.longitude};console.log("pos:"),console.log("moving lat + lng: "+e.lat+" "+e.lng);for(var t=0;t<checkPoints.length;t++){var a=Math.abs(e.lat-checkPoints[t].lat),i=Math.abs(e.lng-checkPoints[t].lng);(a<=1e-5||i<=1e-5)&&(infoWindow.setPosition(e),infoWindow.setContent("CLEARED! "+checkPoints.length+": Remaining"),infoWindow.open(map),map.setCenter(e),console.log("popping put point"),console.log(checkPoints[t]),checkPoints.splice(t,1),console.log(checkPoints.length+" checkPoints Remaining")),0==checkPoints.length&&(clearInterval(n),alert("Is stefan a compulsive gambler!?!"))}})},1e3)}),$(document).ready(function(){$("#save").on("click",function(){event.preventDefault(),console.log("save clicked");var n=checkPoints;console.log("saving new race: "+n);var o={race:n};JSON.stringify(o);$.ajax({url:"/race",type:"POST",data:o}).done(function(n){console.log("Thanks for the race: "+o)})})});